library(diversitree)
library(phytools)

source("unittest_R_utils.R")

## BiSSE
## params
b0 <- 0.5
b1 <- 1.5
d0 <- d1 <- 0.25
q01 <- 0.8
q10 <- 0.4

pars <- c(b0, b1, d0, d1, q01, q10)

## simulation specs
n.batches <- 100
n.sim <- 100
size.tr <- 50 # for simulations with max.taxa
max.age <- 3 # for simulatioons with max.age

## storing things
trs.list.max.taxa <- rep(list(vector(mode="list", length=n.sim)), n.batches) # store trees with different ages, same number of extant taxa
spec.df.max.taxa <- as.data.frame(matrix(rep(0, n.batches * n.sim * 5), nrow=n.batches * n.sim))

trs.list.max.t <- rep(list(vector(mode="list", length=n.sim)), n.batches) # store trees with different numbers of extant taxa, same origin age (but different root age)
spec.df.max.t <- as.data.frame(matrix(rep(0, n.batches * n.sim * 5), nrow=n.batches * n.sim))

names(spec.df.max.taxa) <- names(spec.df.max.t) <-  c("ntotal", "ntips", "n0", "n1", "root.age")

## simulation of 100 batches, each with 100 trees inside
##
## 'diversitree' simulates from the origin, as specified in its documentation:
## "The phylogeny will begin from a single lineage in state x0, but the final phylogeny will include only branches above the first split."
##
## 'diversitree' conditions on the root speciating implicitly (which is why so many trees are returned as NULL; these are likely trees that die off before the root speciates)
##
## trees simulated with max.t will have varying root ages < max.t, because max.t applies to the origin age

######## max.taxa ########
set.seed(123)
null.count <- 0
for (b in 1:n.batches) {
    null.count = 0 # in case we want to know anything about this later

    if (b %% 5 == 0) { cat("batch ", b, "\r") }

    for (i in 1:n.sim) {
        tr.max.taxa = NULL

        ## conditioning on speciation (done by default by diversitree)
        while (is.null(tr.max.taxa)) {
            tr.max.taxa = tree.bisse(pars, max.taxa=size.tr, x0=0, include.extinct=TRUE)

            if (!is.null(tr.max.taxa)) {
                trs.list.max.taxa[[b]][[i]] = tr.max.taxa # b-th batch, i-th tree with max.taxa
                ith.specs.df.max.taxa = get.specs(tr.max.taxa, w.states=TRUE, w.root=TRUE)
                spec.df.max.taxa$ntotal[(b-1) * n.batches + i] = ith.specs.df.max.taxa$"n.total"
                spec.df.max.taxa$root.age[(b-1) * n.batches + i] = ith.specs.df.max.taxa$"tr.h"
                spec.df.max.taxa$ntips[(b-1) * n.batches + i] = ith.specs.df.max.taxa$"n.tips"
                spec.df.max.taxa$n0[(b-1) * n.batches + i] = ith.specs.df.max.taxa$"n.0"
                spec.df.max.taxa$n1[(b-1) * n.batches + i] = ith.specs.df.max.taxa$"n.1"
            } else {
                null.count = null.count + 1
            }
        }
    }
}

## getting stats (mean, stdev, stderr) for different tree specs
mean.df.max.taxa <- data.frame(matrix(rep(0.0, 5 * n.batches), nrow=n.batches))
sd.df.max.taxa <- data.frame(matrix(rep(0.0, 5 * n.batches), nrow=n.batches))
stderr.df.max.taxa <- data.frame(matrix(rep(0.0, 5 * n.batches), nrow=n.batches))
names(mean.df.max.taxa) <- names(sd.df.max.taxa) <- names(stderr.df.max.taxa) <- c("ntotal", "ntips", "n0", "n1", "root.age")
n0.ci.width.max.taxa <- n1.ci.width.max.taxa <- root.age.ci.width.max.taxa <- rep(0.0, n.batches)
for (b in 1:n.batches) {
    bth.batch.df.all = spec.df.max.taxa[((b-1) * n.batches + 1):((b-1) * n.batches + n.sim),]
    bth.batch.df = bth.batch.df.all[bth.batch.df.all$ntips==size.tr,]
    mean.df.max.taxa[b,] = sapply(bth.batch.df, mean)
    sd.df.max.taxa[b,] = sapply(bth.batch.df, sd)
    stderr.df.max.taxa[b,] = sd.df.max.taxa[b,] / sqrt(n.sim)

    n0.ci.width.max.taxa[b] = 1.96 * stderr.df.max.taxa[b, "n0"] # actually half width, which we use in unit test
    n1.ci.width.max.taxa[b] = 1.96 * stderr.df.max.taxa[b, "n1"]
    root.age.ci.width.max.taxa[b] = 1.96 * stderr.df.max.taxa[b, "root.age"]
}

## getting means and 95-CI widths (for unit test
cat("\nn0_mean = [", paste(mean.df.max.taxa$n0, collapse=", "), "]\n")
cat("\nn0_ci_width_maxtaxa = [", paste(n0.ci.width.max.taxa, collapse=", "), "]\n")
cat("\nn1_mean = [", paste(mean.df.max.taxa$n1, collapse=", "), "]\n")
cat("\nn1_ci_width_maxtaxa = [", paste(n1.ci.width.max.taxa, collapse=", "), "]\n")
cat("\nroot_ages_mean_maxtaxa = [", paste(mean.df.max.taxa$root.age, collapse=", "), "]\n")
cat("\nroot_ages_ci_width_maxtaxa = [", paste(root.age.ci.width.max.taxa, collapse=", "), "]\n")

## n0_mean = [ 12.0105263157895, 13.4343434343434, 13.2916666666667, 12.5052631578947, 12.7578947368421, 11.8555555555556, 12.2808988764045, 12.8020833333333, 12.3157894736842, 12, 12.4631578947368, 12.5368421052632, 12.4787234042553, 11.7659574468085, 11.9010989010989, 13.1304347826087, 12.5333333333333, 11.8829787234043, 11.9368421052632, 12.3978494623656, 11.7391304347826, 12.1413043478261, 12.8979591836735, 12.59375, 12.1263157894737, 12.6129032258065, 12.5625, 12.2553191489362, 12.4886363636364, 12.8478260869565, 11.7634408602151, 12.3838383838384, 12.7282608695652, 12.3645833333333, 12.2765957446809, 12.4838709677419, 12.6404494382022, 12.0833333333333, 13.2888888888889, 11.6979166666667, 12.5833333333333, 12.2978723404255, 12.25, 11.7395833333333, 12.2234042553191, 11.8865979381443, 12.6595744680851, 12.3626373626374, 12.9468085106383, 11.3645833333333, 12.2903225806452, 12.2783505154639, 12.469387755102, 12.2395833333333, 12.8602150537634, 12.2747252747253, 12.6170212765957, 12.4468085106383, 12.1382978723404, 13.6947368421053, 12.71875, 12.6875, 11.741935483871, 12.9204545454545, 12.0212765957447, 12.6736842105263, 12.319587628866, 12.8367346938776, 12.1075268817204, 12.5578947368421, 12.9278350515464, 12.9473684210526, 12.2386363636364, 13.5217391304348, 12.5483870967742, 12.2765957446809, 12.5, 12.8723404255319, 12.5204081632653, 12.7052631578947, 12.3404255319149, 12.8191489361702, 12.1170212765957, 12.2688172043011, 12.4086021505376, 13.4347826086957, 12.4408602150538, 12.6105263157895, 13, 11.9468085106383, 12.4408602150538, 12.0714285714286, 12.469387755102, 12.5473684210526, 12.4526315789474, 13.2446808510638, 12.6526315789474, 12.4315789473684, 12.8947368421053, 12.4468085106383 ]

## n0_ci_width_maxtaxa = [ 0.822909392526948, 0.889043703689929, 0.965205521246959, 0.82508123974773, 0.862303221689806, 0.772665191158477, 0.787327590932981, 0.822079134578157, 0.811793463326519, 0.756598054044957, 0.835876418369435, 0.86329543251855, 0.764110145726455, 0.798319245625708, 0.748946263748546, 0.943442554076723, 0.982067930555071, 0.833966488180928, 0.751970364668253, 0.829616909738342, 0.918342668901475, 0.739430902925127, 0.916944635142998, 0.807166444062842, 0.830693182929614, 0.92522193842538, 0.910398374339498, 0.818003179988214, 0.844725483903318, 0.909596874948671, 0.743766498318236, 0.71917337508722, 0.87947315484916, 0.910090636511917, 0.771467668049693, 0.823794736072601, 0.810958244776002, 0.819145571108498, 0.946729421351969, 0.758902169919662, 0.881904478258235, 0.920592108506691, 0.842188027511796, 0.812990268818134, 0.908089023540086, 0.797600143988654, 0.854853259170934, 0.862061627479526, 0.844064558114984, 0.849892747619451, 0.841332510192535, 0.87778968353606, 0.815788531321109, 0.88742537022518, 0.881095947247628, 0.877057567134778, 0.675980129639101, 0.823880661174445, 0.867348579553482, 0.872835226737965, 0.853493270716234, 0.796441414239484, 0.657024821226927, 0.753102161199768, 0.785567867177553, 0.817401902706809, 0.73311729088824, 0.880457987663941, 0.912694460953738, 0.787493002581827, 0.858664672976918, 0.930091293427555, 0.846292220492449, 0.809161455378075, 0.697478994742201, 0.779457901948878, 0.780899130894368, 0.885556443484097, 0.884289125643847, 0.823097567348574, 0.745406050912302, 0.739513958617216, 0.736656130054224, 0.878508543158265, 0.871875136352353, 0.819439795589229, 0.73703522180834, 0.840986788806678, 0.881652413779605, 0.82525829764731, 0.770820260960885, 0.943242619465034, 0.764150792049377, 0.787001198506183, 0.800388837194452, 0.966497277501115, 0.860905209687564, 0.842131837542621, 0.924407999779313, 0.885268581921222 ]

## n1_mean = [ 49.0526315789474, 49.0909090909091, 48.6458333333333, 49.4421052631579, 49.5684210526316, 50.6, 49.1910112359551, 48.3229166666667, 49.8526315789474, 49.0434782608696, 48.6526315789474, 49.0105263157895, 49.5957446808511, 49.3297872340426, 49.6923076923077, 48.554347826087, 48.6, 50.0531914893617, 49.2315789473684, 49.1075268817204, 49.8586956521739, 49.6304347826087, 49.4489795918367, 48.84375, 48.5789473684211, 49.1397849462366, 49.6041666666667, 50.1170212765957, 49, 49.1413043478261, 49.0752688172043, 48.7676767676768, 48.0652173913044, 49.4375, 49.3404255319149, 48.8709677419355, 48.4269662921348, 49.8229166666667, 48.2888888888889, 49.6666666666667, 48.9166666666667, 50.5531914893617, 49.4583333333333, 49.6875, 48.7872340425532, 50.2371134020619, 49.9787234042553, 50.1428571428571, 49, 49.4895833333333, 48.6666666666667, 50.2164948453608, 49.8265306122449, 49.3020833333333, 48.8279569892473, 48.6703296703297, 49.5531914893617, 49.468085106383, 48.8617021276596, 48.7052631578947, 48.15625, 48.9791666666667, 50.010752688172, 49.375, 49.4148936170213, 48.8105263157895, 48.8041237113402, 48.734693877551, 49.4838709677419, 50.0210526315789, 49.1546391752577, 49.3894736842105, 49.3636363636364, 48.5326086956522, 49.6666666666667, 49.9148936170213, 49.3125, 49.4255319148936, 49.8367346938776, 50.5052631578947, 48.936170212766, 50.3617021276596, 49.6914893617021, 49.010752688172, 49.5591397849462, 49.2934782608696, 49.752688172043, 50.3684210526316, 48.8842105263158, 48.6276595744681, 49.4623655913978, 49.4897959183673, 49.2448979591837, 49.8526315789474, 49.0210526315789, 49.1914893617021, 49.0736842105263, 48.6210526315789, 49.4210526315789, 48.936170212766 ]

## n1_ci_width_maxtaxa = [ 0.913241517578396, 0.972406948107258, 0.962714754351264, 0.942898313242389, 0.909332786667947, 0.989773289215739, 0.95695582631802, 0.984115525061294, 0.869031875907774, 0.844610313659382, 0.829475297660449, 0.902494672708109, 0.916765379930654, 0.96208596011299, 0.979865973741168, 1.0171452016325, 1.08026992881461, 1.07290769115974, 0.973914543574481, 1.11192588739341, 0.978742001936422, 0.895934153098855, 0.936869452556769, 0.907959067591184, 0.938929776021674, 1.04619059635822, 0.929156716334102, 1.05288905979027, 0.848379659101402, 1.06587280171296, 0.925314137679434, 0.900724915685901, 0.936971082459084, 1.03667140406206, 1.05668651727484, 0.980096208461247, 1.05130156986801, 1.0678691021367, 1.14446850014111, 0.849201069323603, 0.831881705490525, 1.05905431023592, 0.996537655207074, 0.889049604915271, 1.05211038128327, 1.08678906927686, 1.09900614572917, 1.14345332703662, 1.06774891333847, 0.967330694193989, 1.04088546474847, 0.840759092864107, 0.90980568900869, 0.898913799703979, 0.973426292575906, 0.943181174645215, 1.05632049031809, 0.932571942927109, 1.00583538776017, 1.03234510406442, 0.888146565073936, 0.972327686443496, 1.00586084116569, 0.97222490421086, 0.941260721857178, 0.998300967394383, 0.849477419710458, 0.996848973660835, 1.11909444457408, 0.952927931928248, 0.963669520643453, 1.01091198146353, 0.987040540308839, 0.931388670849765, 0.992840515820679, 1.01648073264791, 0.927341565415553, 1.02893300323344, 0.939221700165544, 1.10167094995324, 0.907931736156424, 1.05013709773764, 0.915280622131845, 0.924979264895278, 1.09069330001967, 0.956913691358332, 1.06755125720947, 0.969962029249542, 0.956303244365913, 0.89333545552697, 1.08343214624695, 0.959475801900699, 0.951524441560277, 0.947331693502333, 1.00551440462936, 0.843040907719647, 0.880837182962401, 0.962826274536798, 1.06073696623346, 0.938799459212026 ]

## root_ages_mean_maxtaxa = [ 3.55172673053542, 3.9127941530696, 3.80430236524155, 3.73141417706893, 3.74556420199403, 3.66778891066675, 3.78692902376881, 3.82355427080851, 3.84183817250497, 3.39796869853732, 3.74235553252069, 3.62481722797747, 3.68348713831474, 3.4905364833486, 3.81810100696981, 3.82890319642297, 3.80880424382715, 3.74328937501739, 3.64858811295637, 3.78360095544487, 3.71369231703396, 3.9522425883831, 3.90438932184811, 3.67288412830961, 3.79884982112664, 3.84202517772462, 4.2265311063898, 3.92442063318461, 3.66633567518946, 3.90519524370196, 3.52471406271283, 3.62370284152017, 3.48618096580436, 3.76015121106648, 3.73003110012213, 3.76391373389574, 3.62033392230768, 3.84409305346056, 3.71020837256848, 3.73183352622779, 3.74564098325164, 3.9788601071399, 3.58401971485518, 3.71106697654576, 4.17593358262528, 3.72643511100609, 3.93983044683273, 3.88412385660439, 3.56812188399591, 3.61818361857227, 3.48258903923192, 3.78035893877615, 4.11804122568628, 3.68410297548811, 3.62766205435023, 3.75966381109593, 3.55533251807556, 3.77592628858866, 3.77846953611231, 3.93273223188244, 3.71778065650567, 3.82054183789191, 3.5763812100404, 3.82858401874954, 3.72426522210724, 3.71750643708242, 3.57482672841752, 3.92436176028331, 3.65568302579977, 3.76106590011963, 3.86024937603752, 3.74342937935341, 3.76319533044903, 3.6844556766734, 3.9379632770938, 3.73877504348952, 3.67310551279245, 3.91181291298287, 3.89328236529354, 4.11901284215373, 3.59271350915588, 3.86283995250313, 3.88521704143744, 3.93570383469811, 3.71959252602608, 3.8555927333007, 3.68110003385647, 4.01937281069923, 3.61964428541228, 3.4476883192311, 3.65231859420909, 3.61942791920685, 3.82680907358801, 4.01316244739759, 3.87737899433156, 3.8972061633736, 3.59952140342085, 3.57187052195236, 3.79747604161167, 3.70491914421258 ]

## root_ages_ci_width_maxtaxa = [ 0.237212993809004, 0.296979779440502, 0.28806325958551, 0.266263651627938, 0.208575345317851, 0.219387757908826, 0.228462264833061, 0.262163861788498, 0.261355252477221, 0.201814174135395, 0.249221113245812, 0.227648626977026, 0.237461927675334, 0.201605514450131, 0.306443230702792, 0.253880308576643, 0.264693219550334, 0.247337895174861, 0.241695689593438, 0.252664409659066, 0.235370579335703, 0.277314442215125, 0.295148293136944, 0.232284025442549, 0.250796849515626, 0.345442823254911, 0.361594500566786, 0.310413070539827, 0.284136942428714, 0.316424933388719, 0.252354970707, 0.220257230805152, 0.230854563320041, 0.256373129296999, 0.234181478640652, 0.230416800243785, 0.211788777972263, 0.274927260561929, 0.265629656173639, 0.268635899575133, 0.276282070089439, 0.288650303478448, 0.216524899252375, 0.249700782678979, 0.366316701087045, 0.253311517999019, 0.236061913023948, 0.275602678394168, 0.192792682036902, 0.279252545937737, 0.176414003947713, 0.236075981338354, 0.302828249032044, 0.290686064311163, 0.214037457947085, 0.212662394571809, 0.225272421773522, 0.258677463358675, 0.262750401898894, 0.354915786639729, 0.266055800698691, 0.241419983384779, 0.211596214411715, 0.289079919013829, 0.260373512149469, 0.228523191146005, 0.232202052193019, 0.25417826422539, 0.259505274369138, 0.264670809292306, 0.258234211907364, 0.245114095879749, 0.253049897615512, 0.20679941023967, 0.285348557125798, 0.266690612886022, 0.221490727774162, 0.278958598628794, 0.287669065400626, 0.276015513185732, 0.231450002235123, 0.240590876451501, 0.231710272433262, 0.245502953956807, 0.22548404426651, 0.241267274481501, 0.219972841791308, 0.264374424927063, 0.245319021977643, 0.226684738116317, 0.21946245162533, 0.271629194029264, 0.275005878348308, 0.287177471717258, 0.272486464169989, 0.222265234389857, 0.196359245942406, 0.261702987054514, 0.213987492259741, 0.22563362332201 ]


######## max.t ########
set.seed(321)
null.count <- 0
for (b in 1:n.batches) {
    null.count = 0 # in case we want to know anything about this later

    if (b %% 5 == 0) { cat("batch ", b, "\r") }

    for (i in 1:n.sim) {
        tr.max.t = NULL

        while (is.null(tr.max.t)) {
            tr.max.t = tree.bisse(pars, max.t=max.age, x0=0, include.extinct=TRUE)

            if (!is.null(tr.max.t)) {
                trs.list.max.t[[b]][[i]] = tr.max.t # b-th batch, i-th tree with max.t
                ith.specs.df.max.t = get.specs(tr.max.t)
                spec.df.max.t$ntotal[(b-1) * n.batches + i] = ith.specs.df.max.t$"n.total"
                spec.df.max.t$root.age[(b-1) * n.batches + i] = ith.specs.df.max.t$"tr.h"
                spec.df.max.t$ntips[(b-1) * n.batches + i] = ith.specs.df.max.t$"n.tips"
                spec.df.max.t$n0[(b-1) * n.batches + i] = ith.specs.df.max.t$"n.0"
                spec.df.max.t$n1[(b-1) * n.batches + i] = ith.specs.df.max.t$"n.1"
            } else {
                null.count = null.count + 1
            }
        }
    }
}

## getting stats (mean, stdev, stderr) for different tree specs
mean.df.max.t <- data.frame(matrix(rep(0.0, 5 * n.batches), nrow=n.batches))
sd.df.max.t <- data.frame(matrix(rep(0.0, 5 * n.batches), nrow=n.batches))
stderr.df.max.t <- data.frame(matrix(rep(0.0, 5 * n.batches), nrow=n.batches))
names(mean.df.max.t) <- names(sd.df.max.t) <- names(stderr.df.max.t) <- c("ntotal", "ntips", "n0", "n1", "root.age")
n0.ci.width.max.t <- n1.ci.width.max.t <- root.age.ci.width.max.t <- rep(0.0, n.batches)
for (b in 1:n.batches) {
    bth.batch.df = spec.df.max.t[((b-1) * n.batches + 1):((b-1) * n.batches + n.sim),]
    mean.df.max.t[b,] = sapply(bth.batch.df, mean)
    sd.df.max.t[b,] = sapply(bth.batch.df, sd)
    stderr.df.max.t[b,] = sd.df.max.t[b,] / sqrt(n.sim)

    n0.ci.width.max.t[b] = 1.96 * stderr.df.max.t[b, "n0"] # actually half width, which we use in unit test
    n1.ci.width.max.t[b] = 1.96 * stderr.df.max.t[b, "n1"]
    root.age.ci.width.max.t[b] = 1.96 * stderr.df.max.taxa[b, "root.age"]
}

## getting means and 95-CI widths used (for unit test)
cat("\nn0_mean = [", paste(mean.df.max.t$n0, collapse=", "), "]\n")
cat("\nn0_ci_width_maxt = [", paste(n0.ci.width.max.t, collapse=", "), "]\n")
cat("\nn1_mean = [", paste(mean.df.max.t$n1, collapse=", "), "]\n")
cat("\nn1_ci_width_maxt =", paste(n1.ci.width.max.t, collapse=", "), "]\n")
cat("\nroot_ages_mean_maxt = [", paste(mean.df.max.t$root.age, collapse=", "), "]\n")
cat("\nroot_ages_ci_width_maxt = [", paste(root.age.ci.width.max.t, collapse=", "), "]\n")

## n0_mean = [ 4.53, 6.42, 3.86, 4.12, 5.07, 5.33, 4.82, 4.48, 4.09, 6.16, 5.39, 3.75, 5.42, 4.33, 4.99, 5.47, 4.43, 4.83, 4.62, 5.15, 4.06, 4.12, 3.99, 4.95, 3.45, 5.3, 5.14, 4.48, 4.86, 5.3, 4.4, 5.18, 5.43, 5.35, 3.75, 4.73, 4.42, 4.06, 4.96, 4.47, 4.85, 5.14, 5.21, 4.23, 5.06, 4.31, 4.77, 3.92, 5.43, 5.26, 4.43, 4.64, 5, 4.91, 4.82, 5.36, 5.23, 5.26, 5.6, 3.65, 4.17, 4.89, 4.52, 6.19, 4.97, 4.07, 4.75, 3.84, 4.06, 4.76, 4.17, 4.97, 5.28, 5.23, 4.92, 5.46, 4.4, 5.3, 4.76, 3.58, 5.55, 4.6, 4.77, 4.46, 4.96, 4.61, 4.7, 4.97, 5.43, 4.34, 5.19, 4.31, 4.42, 4.6, 3.74, 5.2, 4.17, 3.94, 3.14, 4.34 ]

## n0_ci_width_maxt = [ 1.01842872915273, 1.60110418263034, 0.794335708995799, 0.961928077279474, 1.07651592978028, 1.29174936493818, 0.971201880416864, 1.0429102218835, 0.811767413572, 1.20427477249869, 1.10940645082464, 0.79986349845559, 1.23181884802248, 0.978238376270365, 1.02679204193144, 1.0823396214505, 1.05319389257322, 1.26104411508956, 1.00474394426409, 0.956708055276166, 0.752079260813283, 1.08227687863144, 0.916994915553797, 1.18859501135168, 0.714809206725964, 1.18798272272578, 1.10383983906318, 1.04662435428854, 1.12955405806938, 1.18176030316702, 0.709701658758414, 1.11620097100691, 1.00685621414361, 1.38154758780642, 0.871822310688446, 1.00322693163792, 0.900204453544759, 0.980126698880602, 1.0082677085582, 0.913586331692055, 0.93122139844899, 1.36903275093451, 1.38012001176299, 0.99740817333849, 1.03781523744388, 0.914537263573577, 0.979744572773326, 0.800496347034864, 1.16381223172257, 1.49103206016653, 0.914774842088025, 1.146771315873, 0.99395717648542, 1.22039862273924, 1.00728969361782, 1.2119193252478, 1.25388483739718, 1.24355705128393, 1.57146082716469, 0.704970033033141, 0.871234592258293, 1.03221967672105, 1.05143311223061, 1.54774828376548, 1.1460723554996, 1.05393051809391, 1.18237581405261, 0.754088807566436, 0.914165923537722, 0.924842786749197, 0.894528924951987, 1.03693058396384, 1.50410692506224, 1.19038272158091, 1.11942938999828, 1.25127173061585, 1.11328390382016, 1.17748391226223, 1.08687079250294, 0.790496518050842, 1.41512526482694, 0.930648258913206, 1.01896201572725, 0.938710642909257, 1.11951258080732, 0.905240213892691, 1.25840887190487, 1.24194431534761, 1.15745988066694, 1.08833361195412, 0.944182261980378, 0.986391721724624, 0.913044622362041, 1.03488719924034, 0.816307848445881, 1.12196393467307, 1.03152773705957, 0.797164027834126, 0.633442419951442, 0.944398002042903 ]

## n1_mean = [ 7.22, 11.29, 7.15, 8.06, 9.41, 10.09, 8.02, 8.21, 8.32, 11.87, 8.48, 6.65, 8.7, 7.56, 8.2, 9.36, 8.74, 8.87, 9.75, 10.13, 8.04, 7.64, 6.81, 7.93, 7.81, 10.21, 8.11, 8.18, 7.61, 9.43, 8.03, 9.89, 9.67, 9.18, 7.35, 9.4, 6.84, 7.74, 9.09, 6.81, 8.93, 8.35, 8.61, 7.89, 9.29, 8.86, 8.69, 6.62, 9.53, 8.91, 7.96, 8.14, 8.53, 8.76, 8.12, 8.75, 8.91, 9.58, 9.74, 6.66, 7.95, 9.67, 8.69, 10.86, 8.33, 7.97, 9.47, 7.98, 8.32, 9.14, 8.27, 9.68, 9.54, 9.45, 8.81, 10.28, 7.92, 10.55, 9.62, 7.93, 9.88, 8.72, 7.72, 9.09, 9.4, 8.43, 8.65, 8.61, 11.41, 7.08, 9.4, 7.25, 7.87, 8.49, 6.31, 9.42, 8.73, 7.31, 5.7, 8.19 ]

## n1_ci_width_maxt = 1.94660643991516, 2.79295849340061, 1.50701807379589, 1.78375772418394, 2.23111094092317, 2.22396868628489, 1.90130715099487, 1.96223490763142, 2.22358217716051, 2.66270661447097, 1.98683655812119, 1.53710149635638, 2.03889108303628, 1.86261363625949, 1.86483728539787, 2.29851813624045, 2.29819735207639, 2.47164729954201, 2.23758537786434, 2.14664857172874, 1.57907743632128, 2.08164903707021, 1.80191159504667, 1.67479967190411, 1.96251174413265, 2.81592730019793, 1.70798309976736, 2.00702623416996, 1.78399156541015, 2.53773845107423, 1.54844009665511, 2.32927015195921, 2.23770329985497, 2.45885428719486, 1.88334285865116, 2.34572226175499, 1.55625540943443, 2.51305604900777, 1.98167671848, 1.44827819136931, 2.08234516239588, 1.92410927050635, 2.72283280263609, 1.81375992263852, 2.06494961280762, 2.15483340338961, 1.61882308614698, 1.64051135462284, 2.28088201653074, 2.82841204518962, 1.73414274062099, 2.14852139111548, 1.96759858392782, 2.55265892636353, 1.68842000423682, 2.31078492939066, 2.4161443595242, 2.56283272441518, 2.45699769950107, 1.63469170182025, 1.83428496513855, 2.16436282587283, 2.23989413133656, 2.99071008871597, 2.32045067409525, 2.02321607807616, 2.61577551039994, 1.62702062517581, 2.19459890760306, 1.86400893221946, 2.15354275030094, 2.39238433992095, 2.81566890959943, 1.99402934033103, 1.9243754601208, 2.35843872890092, 2.11844918921194, 2.30254186287742, 2.22600656374104, 1.88743445176169, 3.36799857386183, 2.10860831734099, 1.84182281954206, 2.0233388224178, 2.29200588784126, 2.0294971665639, 2.37896454005273, 2.34388450055014, 2.80083889857264, 1.80470573935381, 1.76212919876248, 2.00857140045035, 2.04595017801243, 2.11236188321428, 1.58979825363872, 2.37321682928212, 2.08059275586492, 1.74813315212994, 1.13759164354998, 2.13977570390691 ]

## root_ages_mean_maxt = [ 2.00732372015192, 2.10257928188434, 1.96924293478096, 2.08250892711859, 2.02606497794669, 2.1910383608989, 2.144213932243, 2.05344591114125, 2.10888450947495, 2.13939132596943, 2.02240137059822, 2.00589399615393, 2.08575353049747, 2.05458060433435, 2.11653820081295, 2.17023732987548, 1.91592946420162, 1.93555734662312, 2.09715568896766, 2.07068452260627, 1.94676783383699, 2.02640356283249, 1.94946190589675, 2.04421288948422, 1.9994327048228, 2.06766611347784, 2.08509584760876, 2.03834627098419, 2.00618234613033, 2.15702796870466, 2.03767685320768, 2.1500388013299, 2.16908041892826, 2.05761919687995, 1.96151561929508, 1.99680070282347, 1.99081726249908, 2.0020929100754, 2.09287663009162, 2.07952960521424, 2.11666124170689, 2.0843141751505, 2.03625917344531, 1.94875032408262, 2.11529827531097, 2.00261143960927, 2.0075434821194, 1.91984485471279, 2.16721120245804, 2.00071729007383, 2.05601090136388, 2.06827967482995, 2.01059498587899, 2.06315000226629, 2.06143741551062, 1.9953055160624, 1.93319966731066, 2.04575552601094, 1.95284027914759, 1.90526435624664, 2.01664689527347, 2.0020219815412, 1.91649329880205, 2.16094830412944, 2.02470068767687, 1.93669068777118, 1.99753587691501, 1.99380890942962, 1.9595439348218, 2.13792713239682, 1.95396613994661, 1.87821353516645, 2.09743180648574, 2.09572419802156, 2.15962745109445, 2.19517653866974, 2.01542282351472, 2.0439752160935, 2.1361131092323, 1.92635463251225, 2.06472685735143, 1.93991676414349, 2.11393395125013, 2.1018255016506, 2.09268604725736, 2.04155509875933, 1.89302471893026, 2.04282570807596, 2.13749597206643, 1.95231362180622, 2.12001314945457, 2.02511639478348, 1.9267504893811, 2.11211125949106, 2.0050087749629, 2.04797546625838, 1.97387690374822, 2.04193431544719, 2.04275906552701, 2.07206553135074 ]

## root_ages_ci_width_maxt = [ 0.297091385854989, 0.296201258364643, 0.364677547007252, 0.403410726912187, 0.30510452309174, 0.332343398872262, 0.351974400796566, 0.371568927607893, 0.297531811009305, 0.269371236670627, 0.363329989787168, 0.260701089242488, 0.300001568287857, 0.2530829110793, 0.270014664456289, 0.242136675205298, 0.318485244803122, 0.257715075020624, 0.25907057622389, 0.318105354093215, 0.295649788296284, 0.311937665024648, 0.305725412362601, 0.332610918147052, 0.345035665033601, 0.346490614568642, 0.370157999432243, 0.316642772699646, 0.358319231492461, 0.285686778286896, 0.235180477377879, 0.320436587439621, 0.245151314575713, 0.283951344103828, 0.344043808743368, 0.221872924471466, 0.362864547425411, 0.308158207188226, 0.269551937319812, 0.380830627500729, 0.310512688872746, 0.341875659534818, 0.260369097203599, 0.386563845965079, 0.272009984464708, 0.344875889238449, 0.300178558228157, 0.29843094916527, 0.289186417553936, 0.286954801361071, 0.321754021568278, 0.281748836173812, 0.256108929712384, 0.307933933303829, 0.325808767321394, 0.312068840058396, 0.347252738581748, 0.332694301661293, 0.275018954210629, 0.30645146122481, 0.293173460034019, 0.351531190777319, 0.267837033908018, 0.294715004084522, 0.347381154902021, 0.325611688392348, 0.286164044316842, 0.376131282477176, 0.320331348113289, 0.294079255065471, 0.232423419170186, 0.36972671927173, 0.293116813409044, 0.21141538360236, 0.263866004795028, 0.294293160168103, 0.314429317812875, 0.356704136939503, 0.27014180128031, 0.28571716587361, 0.43447488617703, 0.279609392718712, 0.306019862379033, 0.264160807235181, 0.283032353344332, 0.306969205178319, 0.325236488829131, 0.310253519049271, 0.272322060747632, 0.255640803405894, 0.249799371340539, 0.348720429600812, 0.365819330062694, 0.329868016278265, 0.294871195211231, 0.272180825217148, 0.293453252979965, 0.328912047324881, 0.359020707335335, 0.506617695105554 ]
